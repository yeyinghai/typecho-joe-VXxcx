<!--pages/category/category.wxml-->
<view class="category-container">
  <!-- å·¦ä¾§åˆ†ç±»åˆ—è¡¨ -->
  <scroll-view class="category-sidebar" scroll-y>
    <view wx:if="{{categoriesLoading}}" class="loading">åŠ è½½ä¸­...</view>

    <view wx:elif="{{categories.length}}" class="category-list">
      <view
        class="category-item {{activeCategory == (item.mid || item.id) ? 'active' : ''}}"
        wx:for="{{categories}}"
        wx:key="mid"
        bindtap="handleCategoryTap"
        data-id="{{item.mid || item.id}}"
      >
        <view class="category-name">{{item.name}}</view>
      </view>
    </view>

    <view wx:else class="empty">æš‚æ— åˆ†ç±»</view>
  </scroll-view>

  <!-- å³ä¾§æ–‡ç« åˆ—è¡¨ -->
  <scroll-view
    class="posts-content"
    scroll-y
    bindscrolltolower="handleScrollToLower"
    lower-threshold="100"
  >
    <view wx:if="{{!activeCategory}}" class="empty-state">
      <view class="empty-icon">ðŸ“‚</view>
      <view class="empty-text">è¯·é€‰æ‹©ä¸€ä¸ªåˆ†ç±»</view>
    </view>

    <view wx:elif="{{postsLoading && !posts.length}}" class="loading">åŠ è½½ä¸­...</view>

    <view wx:elif="{{posts.length}}" class="posts-list">
      <view
        class="post-item"
        wx:for="{{posts}}"
        wx:key="cid"
        bindtap="handlePostTap"
        data-id="{{item.cid || item.id}}"
      >
        <!-- æ–‡ç« ç¼©ç•¥å›¾ -->
        <image
          wx:if="{{item.thumbnail}}"
          class="post-thumbnail"
          src="{{item.thumbnail}}"
          mode="aspectFill"
        ></image>

        <!-- æ–‡ç« å†…å®¹ -->
        <view class="post-body">
          <view class="post-title">{{item.title}}</view>
          <view class="post-excerpt">{{item.excerpt}}</view>
          <view class="post-meta">
            <text class="meta-item">{{item.created}}</text>
          </view>
        </view>
      </view>

      <!-- åŠ è½½æ›´å¤š -->
      <view wx:if="{{postsLoading}}" class="loading-more">åŠ è½½ä¸­...</view>
      <view wx:elif="{{!hasMore}}" class="no-more">æ²¡æœ‰æ›´å¤šäº†</view>
    </view>

    <view wx:else class="empty-state">
      <view class="empty-icon">ðŸ“„</view>
      <view class="empty-text">è¯¥åˆ†ç±»ä¸‹æš‚æ— æ–‡ç« </view>
    </view>
  </scroll-view>
</view>
