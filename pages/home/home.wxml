<!--pages/home/home.wxml-->
<view class="home-container">
  <!-- æ¨èæ–‡ç« åŒºåŸŸ -->
  <view class="section featured-section">
    <view class="section-header">
      <text class="section-title">ğŸ“Œ æ¨èé˜…è¯»</text>
    </view>

    <view wx:if="{{featuredLoading}}" class="loading">åŠ è½½ä¸­...</view>

    <view wx:elif="{{featuredPosts.length}}" class="featured-list">
      <swiper class="featured-swiper" indicator-dots indicator-color="rgba(255,255,255,0.5)" indicator-active-color="#fff" circular autoplay interval="5000">
        <swiper-item wx:for="{{featuredPosts}}" wx:key="id">
          <view class="featured-item" bindtap="handlePostTap" data-id="{{item.id}}">
            <image wx:if="{{item.thumbnail}}" class="featured-image" src="{{item.thumbnail}}" mode="aspectFill"></image>
            <view class="featured-content">
              <view class="featured-title">{{item.title}}</view>
            </view>
          </view>
        </swiper-item>
      </swiper>
    </view>

    <view wx:else class="empty">æš‚æ— æ¨èæ–‡ç« </view>
  </view>

  <!-- åˆ†ç±»ç»Ÿè®¡åŒºåŸŸ -->
  <view class="section categories-section">
    <view class="section-header">
      <text class="section-title">ğŸ“‚ æ–‡ç« åˆ†ç±»</text>
    </view>

    <view wx:if="{{categoriesLoading}}" class="loading">åŠ è½½ä¸­...</view>

    <scroll-view wx:elif="{{categories.length}}" class="categories-scroll" scroll-x>
      <view class="categories-list">
        <view class="category-item {{item.styleClass}}" wx:for="{{categories}}" wx:key="mid" bindtap="handleCategoryTap" data-id="{{item.mid || item.id}}">
          <view class="category-name">{{item.name}}</view>
          <view class="category-count">{{item.count || 0}} ç¯‡</view>
        </view>
      </view>
    </scroll-view>

    <view wx:else class="empty">æš‚æ— åˆ†ç±»</view>
  </view>

  <!-- æ–‡ç« åˆ—è¡¨ï¼ˆç€‘å¸ƒæµï¼‰ -->
  <view class="section posts-section">
    <view class="section-header">
      <text class="section-title">ğŸ“ æœ€æ–°æ–‡ç« </text>
    </view>

    <!-- è°ƒè¯•ä¿¡æ¯ -->
    <view wx:if="{{!postsLoading && posts.length === 0}}" class="empty">
      <text>æš‚æ— æ–‡ç« æ•°æ®</text>
    </view>

    <view wx:if="{{posts.length > 0}}" class="waterfall-container">
      <!-- å·¦åˆ— -->
      <view class="waterfall-column">
        <view class="post-card" wx:for="{{leftPosts}}" wx:key="id" bindtap="handlePostTap" data-id="{{item.id}}">
          <image wx:if="{{item.thumbnail}}" class="post-thumbnail" src="{{item.thumbnail}}" mode="aspectFill"></image>
          <view class="post-content">
            <view class="post-title">{{item.title}}</view>
            <view class="post-excerpt">{{item.excerpt}}</view>
            <view class="post-meta">
              <text class="meta-item">{{item.created}}</text>
            </view>
          </view>
        </view>
      </view>

      <!-- å³åˆ— -->
      <view class="waterfall-column">
        <view class="post-card" wx:for="{{rightPosts}}" wx:key="id" bindtap="handlePostTap" data-id="{{item.id}}">
          <image wx:if="{{item.thumbnail}}" class="post-thumbnail" src="{{item.thumbnail}}" mode="aspectFill"></image>
          <view class="post-content">
            <view class="post-title">{{item.title}}</view>
            <view class="post-excerpt">{{item.excerpt}}</view>
            <view class="post-meta">
              <text class="meta-item">{{item.created}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view wx:if="{{postsLoading}}" class="loading">åŠ è½½ä¸­...</view>
    <view wx:elif="{{!hasMore && posts.length}}" class="no-more">æ²¡æœ‰æ›´å¤šäº†</view>
  </view>
</view>
