<!--pages/home/home.wxml-->
<view class="home-container">
  <!-- æ¨èæ–‡ç« åŒºåŸŸ -->
  <view class="section featured-section">
    <view class="section-header">
      <text class="section-title">ğŸ“Œ æ¨èé˜…è¯»</text>
    </view>

    <view wx:if="{{featuredLoading}}" class="loading">åŠ è½½ä¸­...</view>

    <view wx:elif="{{featuredPosts.length}}" class="featured-list">
      <swiper class="featured-swiper" indicator-dots indicator-color="rgba(255,255,255,0.5)" indicator-active-color="#fff" circular autoplay interval="5000">
        <swiper-item wx:for="{{featuredPosts}}" wx:key="id">
          <view class="featured-item" bindtap="handlePostTap" data-id="{{item.id}}">
            <image wx:if="{{item.thumbnail}}" class="featured-image" src="{{item.thumbnail}}" mode="aspectFill"></image>
            <view class="featured-content">
              <view class="featured-title">{{item.title}}</view>
            </view>
          </view>
        </swiper-item>
      </swiper>
    </view>

    <view wx:else class="empty">æš‚æ— æ¨èæ–‡ç« </view>
  </view>

  <!-- åˆ†ç±»ç»Ÿè®¡åŒºåŸŸ -->
  <view class="section categories-section">
    <view class="section-header">
      <text class="section-title">ğŸ“‚ æ–‡ç« åˆ†ç±»</text>
    </view>

    <view wx:if="{{categoriesLoading}}" class="loading">åŠ è½½ä¸­...</view>

    <scroll-view wx:elif="{{categories.length}}" class="categories-scroll" scroll-x>
      <view class="categories-list">
        <view class="category-card" wx:for="{{categories}}" wx:key="mid" bindtap="handleCategoryTap" data-id="{{item.mid || item.id}}">
          <!-- èƒŒæ™¯å›¾ç‰‡åŒºåŸŸ -->
          <view class="category-bg" style="background-image: url('{{item.bgImage}}');">
            <!-- ä¸­é—´æ˜¾ç¤ºåˆ†ç±»åç§° -->
            <view class="category-name-overlay">{{item.name}}</view>
            <!-- å·¦ä¸‹è§’æ˜¾ç¤ºæ–‡ç« æ•°é‡ -->
            <view class="category-count-badge">{{item.count || 0}} ç¯‡</view>
          </view>
        </view>
      </view>
    </scroll-view>

    <view wx:else class="empty">æš‚æ— åˆ†ç±»</view>
  </view>

  <!-- æ–‡ç« åˆ—è¡¨ -->
  <view class="section posts-section">
    <view class="section-header">
      <text class="section-title">ğŸ“ æœ€æ–°æ–‡ç« </text>
    </view>

    <!-- è°ƒè¯•ä¿¡æ¯ -->
    <view wx:if="{{!postsLoading && posts.length === 0}}" class="empty">
      <text>æš‚æ— æ–‡ç« æ•°æ®</text>
    </view>

    <view wx:if="{{posts.length > 0}}" class="posts-list">
      <view class="post-item" wx:for="{{posts}}" wx:key="id" bindtap="handlePostTap" data-id="{{item.id}}">
        <!-- å·¦ä¾§ç¼©ç•¥å›¾ -->
        <image wx:if="{{item.thumbnail}}" class="post-thumb" src="{{item.thumbnail}}" mode="aspectFill"></image>
        <view wx:else class="post-thumb-placeholder">æš‚æ— å›¾ç‰‡</view>

        <!-- å³ä¾§å†…å®¹ -->
        <view class="post-info">
          <view class="post-title">{{item.title}}</view>
          <view class="post-excerpt">{{item.excerpt}}</view>
          <view class="post-meta">
            <text class="meta-item">{{item.created}}</text>
            <text class="meta-item" wx:if="{{item.views !== undefined}}">ğŸ‘ï¸ {{item.views}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view wx:if="{{postsLoading}}" class="loading">åŠ è½½ä¸­...</view>
    <view wx:elif="{{!hasMore && posts.length}}" class="no-more">æ²¡æœ‰æ›´å¤šäº†</view>
  </view>
</view>
